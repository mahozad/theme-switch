{"version":3,"sources":["theme-switch.js"],"names":[],"mappings":"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","file":"theme-switch.min.js","sourcesContent":["/*\r\n* NOTE: Do not use this script as an ES6 module.\r\n*  ES6 modules are deferred and we don't want that because\r\n*  we want the user previous theme selection to be applied\r\n*  as soon as possible (before the page is rendered).\r\n* */\r\n\r\n/*\r\n* There are two types of modules mostly used in JavaScript.\r\n* One is created by Node.js and is used inside the Node environment\r\n* and has been available for a long time. It is called CommonJS.\r\n* Another is the standard native JavaScript modules introduced in ES6.\r\n*\r\n* The Node variant (CommonJS) uses `module.exports` (or simply `exports`) and\r\n* `require()` to export and import scripts, functions, variables, etc.\r\n* Browsers do not know about `exports` or `require` functions and throw error\r\n* because they are objects and functions created just in Node environment and set globally.\r\n* If you want to use this type of module in browsers, you should bundle the files\r\n* (merge all of them into a single JS file which eliminates the need for exports and require)\r\n* with tools like babel, webpack, rollup, etc.\r\n*\r\n* ES6 modules use `export` and `import` keywords for the same purpose.\r\n*\r\n* Example Node modules:\r\n*\r\n* my-calculator.js\r\n* const PI = 3.14;\r\n* function calculate() {}\r\n* modules.exports.calculate = calculate;\r\n* modules.exports.PI = PI;\r\n*\r\n* main.js\r\n* const calculator = require(\"my-calculator\");\r\n* const perimeter = 2 * calculator.PI;\r\n* const result = calculator.calculate();\r\n*\r\n* Example ES6 modules:\r\n*\r\n* my-calculator.js\r\n* export const PI = 3.14;\r\n* export function calculate() {}\r\n*\r\n* main.js\r\n* import { calculate, PI } from \"my-calculator.js\";\r\n* const perimeter = 2 * PI;\r\n* const result = calculate();\r\n*\r\n* See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules\r\n* and https://stackoverflow.com/a/9901097/8583692\r\n* */\r\n\r\n/*\r\n* Minify the script either through command line with babel:\r\n* - babel theme-switch.js --source-maps --out-file result.min.js\r\n* or with babel-minify (also has an alias called minify) which is useful if\r\n* you don't already use babel (as a preset) or want to run minification standalone.\r\n* Note that it does not take into account babel.config.json settings.\r\n* - babel-minify (or minify) theme-switch.js --mangle --no-comments --out-file result.min.js`\r\n* Or automate it with IntelliJ file watcher\r\n* - babel\r\n*   + program: $ProjectFileDir$\\node_modules\\.bin\\babel\r\n*   + arguments: $FilePathRelativeToProjectRoot$ --out-file $FileNameWithoutExtension$.min.js --source-maps\r\n*   Note that setting \"sourceMaps\": \"true\" in babel.config.json does not work because of\r\n*   this bug: https://github.com/babel/babel/issues/5261 (\"sourceMaps\": \"inline\" works, however)\r\n* - UglifyJS\r\n* - YUI compressor (seems to be deprecated and removed in newer versions of IntelliJ)\r\n*\r\n* Babel preset-env inserts a semicolon at the start of the minified file.\r\n* See why: https://stackoverflow.com/q/1873983/8583692\r\n* */\r\n\r\n// TODO: extract Jest configuration to a jest.config.js file\r\n// TODO: Add an attribute so the user can define key name stored in localstorage\r\n\r\n/*\r\n* NOTE: To avoid name collisions if another script declares variables or functions with the same name\r\n*  as ours (i.e. defining them in the global scope) and browsers complaining about identifiers\r\n*  being redeclared, we wrap all our code in a closure or IIFE (sort of creating a namespace for it).\r\n*  ES6 now supports block scope as well (simply wrapping the whole code in {}).\r\n*  I am now using the babel-plugin-iife-wrap plugin to wrap the whole result (minified)\r\n*  code in an IIFE.\r\n* For examples, see these libraries:\r\n*   - https://github.com/highlightjs/highlight.js/blob/main/src/highlight.js\r\n*   - https://github.com/jashkenas/underscore/blob/master/underscore.js\r\n* See\r\n*   - https://www.w3schools.com/js/js_scope.asp\r\n*   - https://github.com/jhnns/rewire/issues/136#issuecomment-380829197\r\n*   - https://stackoverflow.com/a/32750216/8583692\r\n*   - https://stackoverflow.com/q/8228281/8583692\r\n*   - https://stackoverflow.com/q/881515/8583692\r\n*   - https://stackoverflow.com/q/39388777/8583692\r\n*   - https://stackoverflow.com/a/47207686/8583692\r\n* We could also do something like these libraries:\r\n*   - https://github.com/juliangarnier/anime/blob/master/build.js\r\n*   - https://github.com/mrdoob/three.js/\r\n*   - https://github.com/moment/moment\r\n*   - https://github.com/floating-ui/floating-ui\r\n* */\r\n\r\nconst ICON_SIZE = 24 /* px */;\r\nconst ICON_COLOR = \"#000\";\r\nconst THEME_KEY = \"theme\";\r\nconst THEME_AUTO = \"auto\";\r\nconst THEME_DARK = \"dark\";\r\nconst THEME_LIGHT = \"light\";\r\nconst THEME_VALUES = [THEME_AUTO, THEME_DARK, THEME_LIGHT];\r\nconst THEME_DEFAULT = THEME_LIGHT;\r\nconst THEME_ATTRIBUTE = \"data-theme\";\r\nconst COLOR_SCHEME_DARK = \"(prefers-color-scheme: dark)\";\r\n\r\n// circleRadius, raysOpacity, eclipseCenterX, letterOffset\r\nconst ICON_INITIAL_STATE_FOR_AUTO = [10, 0, 33, 0];\r\nconst ICON_INITIAL_STATE_FOR_DARK = [10, 0, 20, 1];\r\nconst ICON_INITIAL_STATE_FOR_LIGHT = [5, 1, 33, 1];\r\n\r\nclass ThemeSwitchElement extends HTMLElement {\r\n    shadowRoot;\r\n    themeToggleEvent;\r\n    static counter = 0; // See https://stackoverflow.com/a/43116254/8583692\r\n    identifier = ThemeSwitchElement.counter++;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        // See https://stackoverflow.com/q/2305654/8583692\r\n        this.shadowRoot = this.attachShadow({ mode: \"open\" });\r\n        this.shadowRoot.innerHTML = generateIcon(...getInitialStateForIcon());\r\n\r\n        // Add the click listener to the top-most parent (the custom element itself)\r\n        // so the padding etc. on the element be also clickable\r\n        this.shadowRoot.host.addEventListener(\"click\", () => {\r\n            this.toggleTheme();\r\n            this.dispatchEvent(this.themeToggleEvent);\r\n        });\r\n\r\n        // If another theme switch in page toggled, update my icon too\r\n        document.addEventListener(\"themeToggle\", (event) => {\r\n            if (event.detail !== this.identifier) {\r\n                this.reflectTheme();\r\n            }\r\n        });\r\n\r\n        // See https://stackoverflow.com/a/53804106/8583692\r\n        this.themeToggleEvent = new CustomEvent(\"themeToggle\", {\r\n            detail: this.identifier,\r\n            bubbles: true,\r\n            composed: true,\r\n            cancelable: false\r\n        });\r\n\r\n        // Create some CSS to apply to the shadow DOM\r\n        // See https://css-tricks.com/styling-a-web-component/\r\n        const style = document.createElement(\"style\");\r\n        style.textContent = generateStyle();\r\n        this.shadowRoot.append(style);\r\n    }\r\n\r\n    // See https://stackoverflow.com/q/48316611\r\n    toggleTheme() {\r\n        const theme = getUserThemeSelection();\r\n        if (theme === THEME_AUTO) {\r\n            localStorage.setItem(THEME_KEY, THEME_LIGHT);\r\n            this.animateThemeButtonIconToLight();\r\n        } else if (theme === THEME_DARK) {\r\n            localStorage.setItem(THEME_KEY, THEME_AUTO);\r\n            this.animateThemeButtonIconToAuto();\r\n        } else /* if (theme === THEME_LIGHT) */ {\r\n            localStorage.setItem(THEME_KEY, THEME_DARK);\r\n            this.animateThemeButtonIconToDark();\r\n        }\r\n        updateTheme();\r\n    }\r\n\r\n    reflectTheme() {\r\n        const theme = getUserThemeSelection();\r\n        if (theme === THEME_AUTO) {\r\n            this.animateThemeButtonIconToAuto();\r\n        } else if (theme === THEME_DARK) {\r\n            this.animateThemeButtonIconToDark();\r\n        } else /* if (theme === THEME_LIGHT) */ {\r\n            this.animateThemeButtonIconToLight();\r\n        }\r\n    }\r\n\r\n    animateThemeButtonIconToLight() {\r\n        this.shadowRoot.getElementById(\"letter-anim-hide\").beginElement();\r\n        this.shadowRoot.getElementById(\"core-anim-shrink\").beginElement();\r\n        this.shadowRoot.getElementById(\"rays-anim-rotate\").beginElement();\r\n        this.shadowRoot.getElementById(\"rays-anim-show\").beginElement();\r\n    }\r\n\r\n    animateThemeButtonIconToAuto() {\r\n        this.shadowRoot.getElementById(\"eclipse-anim-go\").beginElement();\r\n        this.shadowRoot.getElementById(\"letter-anim-show\").beginElement();\r\n    }\r\n\r\n    animateThemeButtonIconToDark() {\r\n        this.shadowRoot.getElementById(\"rays-anim-hide\").beginElement();\r\n        this.shadowRoot.getElementById(\"core-anim-enlarge\").beginElement();\r\n        this.shadowRoot.getElementById(\"eclipse-anim-come\").beginElement();\r\n    }\r\n}\r\n\r\n// language=html\r\nfunction generateIcon(circleRadius, raysOpacity, eclipseCenterX, letterOffset) {\r\n    return `\r\n    <!-- Using <button> element allows the element to be focused and is more semantic -->\r\n    <button id=\"theme-switch\">\r\n      <!-- See https://stackoverflow.com/q/34393465/8583692 -->\r\n      <svg viewBox=\"0 0 24 24\" width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <defs>\r\n          <mask id=\"mask\">\r\n            <!-- Fill the entire viewBox as the mask default (show everything) -->\r\n            <rect width=\"100%\" height=\"100%\" fill=\"#fff\"/>\r\n            <circle id=\"eclipse\" r=\"10\" cx=\"${eclipseCenterX}\" cy=\"6\">\r\n              <animate id=\"eclipse-anim-come\" fill=\"freeze\" attributeName=\"cx\" to=\"20\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n              <animate id=\"eclipse-anim-go\" fill=\"freeze\" attributeName=\"cx\" to=\"33\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            </circle>\r\n            <!-- See https://youtu.be/7aobRPg7BXI -->\r\n            <path id=\"letter\" fill=\"none\" stroke=\"#000\" stroke-width=\"2\" stroke-linejoin=\"round\" stroke-linecap=\"round\" pathLength=\"1\" stroke-dasharray=\"1 1\" stroke-dashoffset=\"${letterOffset}\" d=\"m8 16.5 4-9 4 9-1-2h-6\">\r\n              <animate id=\"letter-anim-show\" fill=\"freeze\" attributeName=\"stroke-dashoffset\" to=\"0\" dur=\"400ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\".67,.27,.55,.9\"/>\r\n              <animate id=\"letter-anim-hide\" fill=\"freeze\" attributeName=\"stroke-dashoffset\" to=\"1\" dur=\"15ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            </path>\r\n          </mask>\r\n        </defs>\r\n        <g id=\"visible-content\" mask=\"url(#mask)\">\r\n          <g id=\"rays\" opacity=\"${raysOpacity}\" fill=\"none\" stroke=\"#000\" stroke-width=\"2\" stroke-linecap=\"round\">\r\n            <animate id=\"rays-anim-hide\" fill=\"freeze\" attributeName=\"opacity\" to=\"0\" dur=\"100ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            <animate id=\"rays-anim-show\" fill=\"freeze\" attributeName=\"opacity\" to=\"1\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            <animateTransform id=\"rays-anim-rotate\" attributeName=\"transform\" attributeType=\"XML\" type=\"rotate\" from=\"-25 12 12\" to=\"0 12 12\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            <path d=\"m12 1v3\"/>\r\n            <path d=\"m23 12h-3\"/>\r\n            <path d=\"m19.778 4.2218-2.121 2.1213\"/>\r\n            <path d=\"m19.778 19.778-2.121-2.121\"/>\r\n            <path d=\"m4.222 19.778 2.121-2.121\"/>\r\n            <path d=\"m4.222 4.222 2.121 2.121\"/>\r\n            <path d=\"m4 12h-3\"/>\r\n            <path d=\"m12 20v3\"/>\r\n          </g>\r\n          <circle id=\"circle\" r=\"${circleRadius}\" cx=\"12\" cy=\"12\">\r\n            <animate id=\"core-anim-enlarge\" fill=\"freeze\" attributeName=\"r\" to=\"10\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n            <animate id=\"core-anim-shrink\" fill=\"freeze\" attributeName=\"r\" to=\"5\" dur=\"300ms\" begin=\"indefinite\" calcMode=\"spline\" keyTimes=\"0; 1\" keySplines=\"0.37, 0, 0.63, 1\"/>\r\n          </circle>\r\n        </g>\r\n      </svg>\r\n    </button>\r\n    `;\r\n}\r\n\r\n// language=css\r\nfunction generateStyle() {\r\n    return `\r\n    /* :host === the host element of the shadow === <theme-switch> */\r\n    /* See https://developer.mozilla.org/en-US/docs/Web/CSS/:host */\r\n    :host {\r\n      display: flex;\r\n      width: ${ICON_SIZE}px;\r\n      aspect-ratio: 1 / 1;\r\n      /* This is for when the element has padding */\r\n      cursor: pointer;\r\n    }\r\n\r\n    :host([hidden]) { display: none; }\r\n\r\n    button {\r\n      padding: 0;\r\n      border: none;\r\n      background: transparent;\r\n      display: flex;\r\n      /* The host element also has its cursor set */\r\n      cursor: pointer;\r\n    }\r\n\r\n    #circle { fill: var(--theme-switch-icon-color, ${ICON_COLOR}); }\r\n\r\n    #rays { stroke: var(--theme-switch-icon-color, ${ICON_COLOR}); }\r\n    `;\r\n}\r\n\r\nupdateTheme();\r\nwindow.customElements.define(\"theme-switch\", ThemeSwitchElement);\r\nwindow\r\n    .matchMedia(COLOR_SCHEME_DARK)\r\n    .addEventListener(\"change\", updateTheme);\r\n\r\nfunction updateTheme() {\r\n    let theme = getUserThemeSelection();\r\n    if (theme === THEME_AUTO) theme = getSystemTheme();\r\n    document.documentElement.setAttribute(THEME_ATTRIBUTE, theme);\r\n}\r\n\r\nfunction getUserThemeSelection() {\r\n    const userSelection = localStorage.getItem(THEME_KEY);\r\n    return THEME_VALUES.includes(userSelection) ? userSelection : THEME_DEFAULT;\r\n}\r\n\r\nfunction getSystemTheme() {\r\n    const isDark = window.matchMedia(COLOR_SCHEME_DARK).matches;\r\n    return isDark ? THEME_DARK : THEME_LIGHT;\r\n}\r\n\r\nfunction getInitialStateForIcon() {\r\n    const theme = getUserThemeSelection();\r\n    if (theme === THEME_AUTO) {\r\n        return ICON_INITIAL_STATE_FOR_AUTO;\r\n    } else if (theme === THEME_DARK) {\r\n        return ICON_INITIAL_STATE_FOR_DARK;\r\n    } else /* if (theme === THEME_LIGHT) */ {\r\n        return ICON_INITIAL_STATE_FOR_LIGHT;\r\n    }\r\n}\r\n\r\n// Export for tests run by npm (no longer needed; kept for future reference)\r\n// See https://stackoverflow.com/q/63752210/8583692\r\n// and https://stackoverflow.com/a/54680602/8583692\r\n// and https://stackoverflow.com/q/43042889/8583692\r\n// and https://stackoverflow.com/a/1984728/8583692\r\n// if (typeof module !== \"undefined\") {\r\n//     module.exports = {\r\n//         updateTheme,\r\n//         toggleTheme,\r\n//         getSystemTheme,\r\n//         getInitialStateForIcon,\r\n//         animateThemeButtonIconToAuto,\r\n//         animateThemeButtonIconToDark,\r\n//         animateThemeButtonIconToLight\r\n//     };\r\n// }\r\n"]}